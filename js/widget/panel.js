define("widget/panel",["i18n","sos-data-access","locale-date","widget-common"],function(e,t,r,n){"use strict";var a=['<div class="panel widget">',"<h2></h2>","<h3>",e.t("Loading..."),"</h3>",'<dl class="dl-horizontal"></dl>','<div><span class="footnote"></span></div>',"</div>"].join("");return{inputs:n.inputs.concat(["feature","properties","refresh_interval"]),optional_inputs:["title"].concat(n.optional_inputs),preferredSizes:[{w:400,h:400}],init:function(i,o,d){function l(t){if(!t.length)return s.innerHTML=i.title||"",void(p.innerHTML=e.t("(no data)"));var n=new Date(Math.max.apply(Math,t.map(function(e){return e.time})));t.sort(function(e,t){return e.property.localeCompare(t.property)}),s.innerHTML=i.title||e.t("Last measures from")+" "+t[0].feature,p.innerHTML=r.display(n);var a="";for(var o in t){var d=t[o];a+="<dt>"+d.property+"</dt>",a+=d.time.getTime()==n.getTime()?"<dd>"+d.value+" "+d.uom+"</dd>":"<dd class='outdated'>"+d.value+" "+d.uom+"* <span>*("+r.display(d.time)+")</span></dd>"}u.innerHTML=a}o.innerHTML=a;var s=o.querySelector("h2"),p=o.querySelector("h3"),u=o.querySelector("dl");n.init(i,o);var c=t(i,l,d),v=setInterval(c.read,1e3*i.refresh_interval);return c.read(),{destroy:function(){clearInterval(v)}}}}});